Me gustaría saber cómo puedo hacer esta consulta en sql, usando with como tablas temporales, tengo una tabla que se llama tbl_dias_festivos que tiene una columna tipo datetime llamada Fecha_Dia_Festivo, donde están las fechas en formato yyyy-mm-dd (ya están en datetime), que tiene los días que no se trabajan, ya sean festivos o fines de semana, y tengo otra tabla que se llama TMP_DATA.TODOS_LOS_DIAS_YEAR con una columna datetime llamada FECHAS, que tiene  todos los días del año, sin importar si es festivo, fin de semana, etc. y por último, tengo una tabla que se llama INFIDELIDAD_SIE.Tbl_Casos que tiene estas columnas:
['Id_Caso', 'Codigo_LE_SIIFRA', 'Fecha_Registro_Base', 'Origen_Alerta',
       'Area_Origen_Alerta', 'Fecha_Reporte_Canal', 'Fecha_Reporte_SIE',
       'Fecha_Reporte_Jefe_SIE', 'Categoria_Ini_Caso', 'Tipo_Ini_Caso',
       'Criticidad_Caso', 'Comite_Superv_Rpta', 'Nivel_Prioridad',
       'Numero_Denuncia', 'Fecha_Denuncia_Penal', 'Estado_Proceso_Penal',
       'Valor_Pagado_Aseg', 'Satisfacción_Cliente', 'Investigador_Responsable',
       'Fecha_Entrega_Responsable', 'Tiempo_Estimado_Invest', 'Fraude',
       'Modalidad_Fraude', 'Producto_Afectado', 'Categoria_Fin_Caso',
       'Tipo_Fin_Caso', 'Fecha_Ini_Invest', 'Presupuesto_Estimado',
       'Fecha_Ocurrencia', 'Valor_Caso', 'Valor_Protegido', 'Valor_Recuperado',
       'Envio_Informe_GH', 'Fecha_Envio_Informe_GH', 'Envio_Informe_AI',
       'Fecha_Envio_Informe_AI', 'Envio_Informe_AE', 'Fecha_Envio_Informe_AE',
       'Envio_Informe_Comite', 'Fecha_Envio_Informe_Comite',
       'Reclamacion_Aseguradora', 'Valor_Reclamado_Aseg', 'Presupuesto_Real',
       'Privilegio_ClienteAbogado', 'Etapa_Proceso_Invest', 'Estado_Caso',
       'Hallazgos', 'Pendientes', 'Descripcion_Caso', 'Línea_Ética',
       'Fecha_Fin_Invest', 'Mala_Práctica', 'Auxiliar_Apoyo',
       'Contabilización', 'Fecha_Contabilización', 'Tramitadores',
       'Valor_Contabilizacion', 'Tipologia_Asobancaria', 'Fecha_Sentencia',
       'Delito', 'Firma_Abogados', 'Denunciado', 'Cat_Clasificación_Alerta',
       'SubCat_Clasificación_Alerta', 'Tipologia_Mala_Práctica',
       'Fecha_Debe_Cerrar', 'Dias_Meta', 'Pendiente_GH', 'Automatica',
       'Tipo_Alerta', 'Tipo_Empleado', 'Complejidad', 'Envio_Noti_Inicio_Caso',
       'Mesa_Contencion', 'Primer_Contacto', 'Justi_Vencimiento',
       'Dias_Meta_Reg', 'Fecha_Compromiso_Cierre', 'Prorroga_Le']

con un info():
        Data columns (total 79 columns):
 #   Column                       Non-Null Count  Dtype         
---  ------                       --------------  -----         
 0   Id_Caso                      4443 non-null   int64         
 1   Codigo_LE_SIIFRA             4439 non-null   object        
 2   Fecha_Registro_Base          4443 non-null   datetime64[ns]
 3   Origen_Alerta                4443 non-null   object        
 4   Area_Origen_Alerta           4443 non-null   object        
 5   Fecha_Reporte_Canal          1947 non-null   datetime64[ns]
 6   Fecha_Reporte_SIE            4443 non-null   datetime64[ns]
 7   Fecha_Reporte_Jefe_SIE       1947 non-null   datetime64[ns]
 8   Categoria_Ini_Caso           3249 non-null   object        
 9   Tipo_Ini_Caso                3249 non-null   object        
 10  Criticidad_Caso              3249 non-null   object        
 11  Comite_Superv_Rpta           1947 non-null   object        
 12  Nivel_Prioridad              4443 non-null   object        
 13  Numero_Denuncia              254 non-null    object        
 14  Fecha_Denuncia_Penal         192 non-null    datetime64[ns]
 15  Estado_Proceso_Penal         122 non-null    object        
 16  Valor_Pagado_Aseg            0 non-null      object        
 17  Satisfacción_Cliente         216 non-null    object        
 18  Investigador_Responsable     4441 non-null   object        
 19  Fecha_Entrega_Responsable    4441 non-null   datetime64[ns]
 20  Tiempo_Estimado_Invest       1947 non-null   object        
 21  Fraude                       4443 non-null   bool          
 22  Modalidad_Fraude             499 non-null    object        
 23  Producto_Afectado            521 non-null    object        
 24  Categoria_Fin_Caso           686 non-null    object        
 25  Tipo_Fin_Caso                729 non-null    object        
 26  Fecha_Ini_Invest             4441 non-null   datetime64[ns]
 27  Presupuesto_Estimado         97 non-null     float64       
 28  Fecha_Ocurrencia             605 non-null    datetime64[ns]
 29  Valor_Caso                   496 non-null    float64       
 30  Valor_Protegido              100 non-null    float64       
 31  Valor_Recuperado             182 non-null    float64       
 32  Envio_Informe_GH             4443 non-null   bool          
 33  Fecha_Envio_Informe_GH       2447 non-null   datetime64[ns]
 34  Envio_Informe_AI             4443 non-null   bool          
 35  Fecha_Envio_Informe_AI       34 non-null     datetime64[ns]
 36  Envio_Informe_AE             4443 non-null   bool          
 37  Fecha_Envio_Informe_AE       319 non-null    datetime64[ns]
 38  Envio_Informe_Comite         4443 non-null   bool          
 39  Fecha_Envio_Informe_Comite   0 non-null      object        
 40  Reclamacion_Aseguradora      4443 non-null   bool          
 41  Valor_Reclamado_Aseg         5 non-null      float64       
 42  Presupuesto_Real             704 non-null    float64       
 43  Privilegio_ClienteAbogado    4443 non-null   bool          
 44  Etapa_Proceso_Invest         4441 non-null   object        
 45  Estado_Caso                  4443 non-null   object        
 46  Hallazgos                    4289 non-null   object        
 47  Pendientes                   50 non-null     object        
 48  Descripcion_Caso             4443 non-null   object        
 49  Línea_Ética                  4443 non-null   bool          
 50  Fecha_Fin_Invest             4422 non-null   datetime64[ns]
 51  Mala_Práctica                4443 non-null   bool          
 52  Auxiliar_Apoyo               41 non-null     object        
 53  Contabilización              4443 non-null   bool          
 54  Fecha_Contabilización        43 non-null     datetime64[ns]
 55  Tramitadores                 4443 non-null   bool          
 56  Valor_Contabilizacion        41 non-null     float64       
 57  Tipologia_Asobancaria        341 non-null    object        
 58  Fecha_Sentencia              17 non-null     datetime64[ns]
 59  Delito                       105 non-null    object        
 60  Firma_Abogados               205 non-null    object        
 61  Denunciado                   4443 non-null   bool          
 62  Cat_Clasificación_Alerta     3592 non-null   object        
 63  SubCat_Clasificación_Alerta  3593 non-null   object        
 64  Tipologia_Mala_Práctica      1158 non-null   object        
 65  Fecha_Debe_Cerrar            4441 non-null   datetime64[ns]
 66  Dias_Meta                    4441 non-null   float64       
 67  Pendiente_GH                 4443 non-null   bool          
 68  Automatica                   4443 non-null   bool          
 69  Tipo_Alerta                  2119 non-null   object        
 70  Tipo_Empleado                2119 non-null   object        
 71  Complejidad                  3592 non-null   object        
 72  Envio_Noti_Inicio_Caso       4443 non-null   bool          
 73  Mesa_Contencion              4443 non-null   bool          
 74  Primer_Contacto              4443 non-null   bool          
 75  Justi_Vencimiento            201 non-null    object        
 76  Dias_Meta_Reg                4441 non-null   float64       
 77  Fecha_Compromiso_Cierre      225 non-null    datetime64[ns]
 78  Prorroga_Le                  4443 non-null   bool          

 y lo que necesito es hacer un histórico por cada día de los años que hay en el antijoin entre dias_festivos y la tabla de todos los días del año que me diga los casos en proceso y los casos vencidos (también si el caso con menor Fecha_Entrega_Responsable es mayor al menor de esos días, no vale la pena tener esos campos anteriores en 0), ya que sólo necesito los días laborales.
para hallar los casos en proceso, tengo esta lógica en MODELER:
 FECHA>=to_date(Fecha_Entrega_Responsable) and FECHA < to_date(Fecha_Debe_Cerrar)
 y para la lógica de los vencidos en MODELER es:
 se crea una columna '# DIAS ASIGNADO PROME' que es: date_days_difference(Fecha_Entrega_Responsable, FECHA) -'# DIAS NO LABO'
 dias no labo son  los días festivos, sólo que viene de una estrella en MODELER, pero esta columna es un conteo, por los campos(group by) entre los campos id_caso, Fecha_Fin_Invest, investigador, luego esta columna se hace para filtrar de la siguiente manera:
'# DIAS ASIGNADO PROME' > Dias_Meta

Para finalizar, digamos que la lógica es, iterar cada día, para contar los casos vencidos y en proceso, un caso está en proceso si no tiene fecha_fin_invest, pero FECHA es menor a Fecha_Debe_Cerrar, y un caso está vencido, cuando sigue en proceso, pero Fecha es mayor a Fecha_Debe_Cerrar, este ya se deja de contar, cuando tiene fecha_fin_invest diferente de nulo o vacío, así que te di esa lógica, pero si me puedes ayudar de otra forma, estaría perfecto
